<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Manage User</title>
    <th:block th:replace="~{base :: bootstrap}"></th:block>
    <link th:href="@{/css/editUser.css}" rel="stylesheet"/>
</head>
<body>
<div th:replace="~{base :: header}"></div>
<main th:fragment="content" style="padding-top: 5px;">
    <div class="container">
        <h3 class="text-center text-info fw-semibold mb-2 mt-3 title-adduser">Edit User</h3>
        <form th:action="@{/users/add}" method="post" th:object="${user}" enctype="multipart/form-data"
              class="edit-user-form shadow p-4 rounded-4 mx-auto bg-form">
            <div class="row">
                <!-- Cột trái: Thông tin -->
                <div class="col-md-6 col-lg-5 px-4">
                    <div class="mb-3">
                        <label for="email" class="form-label">Email:</label>
                        <input type="email" class="form-control" id="email" name="email" placeholder="Enter your email"
                               th:field="*{email}" required/>
                        <!-- Thông báo lỗi nếu có -->
                        <div th:if="${emailError != null}" class="text-danger mt-1" th:text="${emailError}"></div>
                    </div>

                    <!-- Name -->
                    <div class="mb-3">
                        <label for="username" class="form-label">Name of user:</label>
                        <input type="text" class="form-control" id="username" name="username"
                               placeholder="Enter your name"
                               th:field="*{name}" required/>
                    </div>
                    <!-- Password -->
                    <div class="mb-3">
                        <label for="password" class="form-label">Password:</label>
                        <input type="password" class="form-control" id="password" name="password"
                               placeholder="Nhập mật khẩu" th:field="*{password}" required/>
                    </div>
                    <!-- Role -->
                    <div class="mb-3 mt-3">
                        <label for="role" class="form-label">Role:</label>
                        <select class="form-select" id="role" th:field="*{role}" required>
                            <option value="">Select your choice</option>
                            <option th:each="role: ${roles}" th:value="${role}" th:text="${role}"></option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6 col-lg-5 d-flex flex-column align-items-center justify-content-center px-4">
                    <!-- Preview avatar hình tròn -->
                    <div class="avatar-preview-container mb-3 mt-3">

                        <img id="avatarShowPreview" class="avatar-preview-circle"
                             th:src="${user.avatar != null} ? ${user.avatar} : '@{/static/images/userAvatar.png}'"/>
                    </div>
                    <!-- Trường upload -->
                    <div class="mb-3 w-100">
                        <label for="avatar" class="form-label">Avatar:</label>
                        <input type="file" class="form-control" id="avatar" name="avatar"
                               th:field="*{file}"
                               th:required="${user.id == null}"
                               onchange="previewAvatar(event)"/>
                    </div>
                </div>
                <div class="d-flex justify-content-center mt-4 gap-3">
                    <button class="btn btn-success mt-1" type="submit">
                        <input type="hidden" class="form-control" th:field="*{id}"/>
                        <span th:if="${user.id == null}">Add user</span>
                        <span th:unless="${user.id == null}">Update user</span>
                    </button>
                    <a th:href="@{/users}" class="btn btn-outline-secondary px-4 w-15">Cancel</a>
                </div>
            </div>
        </form>
    </div>
</main>
<div th:replace="~{base :: footer}"></div>
<script>
   function previewAvatar(event) {
    const [file] = event.target.files;
    if (file) {
        document.getElementById('avatarShowPreview').src = URL.createObjectURL(file);
    }
}


</script>
</body>
</html>
